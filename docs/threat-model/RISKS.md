# Реестр рисков и план обработки

## Матрица оценки рисков

| ID | Угроза / Связанный поток | L | I | Risk | Приоритет | Стратегия | Владелец       | Срок | Критерий закрытия |
|----|--------------------------|---|---|------|-----------|-----------|----------------|------|-------------------|
| R-01 | Утечка личных заметок из-за слабого шифрования (F4, F10) | 3 | 5 | 15 | High | **Снизить** | @Vikichuela15  | v1.1 | Реализовано AES-256 (**NFR-01**), пройдены крипто-тесты |
| R-02 | DDoS через массовое добавление цитат (F2) | 4 | 3 | 12 | High | **Снизить** | @Vikichuela15  | v1.2 | Rate limiting (**NFR-05**) настроен и протестирован под нагрузкой |
| R-03 | Недоступность поиска при высокой нагрузке (F3) | 3 | 4 | 12 | High | **Снизить** | @Vikichuela15  | v1.1 | Нагрузочные тесты подтверждают p95 ≤ 100ms (**NFR-02**) |
| R-04 | Подбор паролей пользователей (F1) | 4 | 2 | 8 | Medium | **Снизить** | @Vikichuela15  | v1.0 | Внедрён Argon2id (**NFR-06**) + rate limiting (**NFR-05**) |
| R-05 | Потеря данных из-за отказа БД (F10) | 2 | 5 | 10 | High | **Снизить** | @Vikichuela15       | v1.0 | Настроены бэкапы (**NFR-04, NFR-08**), проверка восстановления |
| R-06 | SQL инъекция в поисковый запрос (F3) | 2 | 4 | 8 | Medium | **Снизить** | @Vikichuela15  | v1.2 | SAST-сканирование (Semgrep) не находит уязвимостей |
| R-07 | Неавторизованный доступ к чужим цитатам (F4) | 3 | 3 | 9 | Medium | **Снизить** | @Vikichuela15  | v1.1 | Реализованы object-level проверки прав доступа |
| R-08 | Компрометация сессий пользователей (F1) | 3 | 3 | 9 | Medium | **Снизить** | @Vikichuela15  | v1.0 | JWT с коротким TTL, защита от CSRF |
| R-09 | Утечка данных через ошибки приложения | 2 | 4 | 8 | Medium | **Снизить** | @Vikichuela15  | v1.1 | Унифицированные ошибки (**Лекция 02**), маскирование логов |
| R-10 | Несоответствие требованиям к производительности | 3 | 3 | 9 | Medium | **Принять** | @Vikichuela15     | v1.0 | Мониторинг SLO, error budget в пределах нормы |

## Детальный план обработки рисков

### Высокоприоритетные риски (Risk ≥ 12)

**R-01: Утечка личных заметок**
- **Меры:**
  - Реализовать AES-256-GCM для шифрования текста цитат
  - Внедрить систему управления ключами (KMS)
  - Добавить аудит операций доступа к зашифрованным данным
- **Метрики успеха:**
  - 100% цитат хранятся в зашифрованном виде
  - Нет утечек ключей шифрования
  - Аудит показывает только авторизованный доступ

**R-02: DDoS через массовое добавление**
- **Меры:**
  - Настроить rate limiting на API Gateway (≤ 10 запросов/мин на пользователя)
  - Реализовать circuit breaker для сервиса цитат
  - Настроить мониторинг аномальной активности
- **Метрики успеха:**
  - Система выдерживает нагрузку в пределах **NFR-05**
  - Автоматическое блокирование ботов
  - Минимальное влияние на легитимных пользователей

**R-03: Недоступность поиска**
- **Меры:**
  - Оптимизация поисковых индексов
  - Кэширование частых запросов (**NFR-02**)
  - Настройка автоскейлинга для поискового сервиса
- **Метрики успеха:**
  - p95 времени ответа ≤ 100ms при пиковой нагрузке
  - 99.9% доступности поискового сервиса

### Среднеприоритетные риски (Risk 8-11)

**R-05: Потеря данных**
- **Меры:**
  - Ежедневные бэкапы БД (**NFR-08**)
  - Регулярные тесты восстановления
  - Мониторинг целостности данных
- **Метрики успеха:**
  - RPO ≤ 24 часа, RTO ≤ 4 часа
  - Успешное восстановление в тестовой среде

**R-07: Неавторизованный доступ**
- **Меры:**
  - Реализация object-level авторизации
  - Тесты на проверку прав доступа
  - Аудит всех операций с цитатами
- **Метрики успеха:**
  - 0 инцидентов несанкционированного доступа
  - 100% покрытие тестами авторизации

## Мониторинг и отчетность

### Ключевые метрики безопасности
- **MTTD** (Mean Time to Detect): ≤ 1 час для критичных инцидентов
- **MTTR** (Mean Time to Resolve): ≤ 4 часа для high-рисков
- **Coverage:** ≥ 95% критичных процессов покрыты аудитом

### Дашборды и алерты
- **Дашборд безопасности:** Мониторинг 429 ошибок, блокировок, аудит-событий
- **Алерты:**
  - P1: >1000 блокировок/5 мин ⇒ @Vikichuela15
  - P2: Сбои шифрования/дешифрования ⇒ @Vikichuela15
  - P3: Нарушение SLO производительности ⇒ @Vikichuela15

## Связь с бэклогом разработки

| Risk ID | Задача в бэклоге | Статус | Sprint |
|---------|------------------|--------|--------|
| R-01 | STOR-001: Реализация шифрования цитат | To Do | Sprint 3 |
| R-02 | API-004: Настройка rate limiting | In Progress | Sprint 2 |
| R-03 | SEARCH-005: Оптимизация поискового индекса | Done | Sprint 1 |
| R-05 | OPS-001: Автоматизация бэкапов | Done | Sprint 1 |
| R-07 | AUTH-003: Object-level авторизация | To Do | Sprint 3 |
